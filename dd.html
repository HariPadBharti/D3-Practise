<!DOCTYPE html>

	<head>
    <h3 style = "color:blue"> HARI PAD BHARTI </h3>
<h4 class = "cls"> 01591571 <h4>

<h4 class = "cls" > Data Visualization CIS 602-01 </h4>
<h3 class = "cls1"> Final Project </h3>


	 <meta charset="utf-8">
        <link href="https://d3-geomap.github.io//d3-geomap/css/d3.geomap.css" rel="stylesheet">
        <script src="https://d3-geomap.github.io//d3-geomap/vendor/d3.geomap.dependencies.min.js"></script>
        <script src="https://d3-geomap.github.io//d3-geomap/js/d3.geomap.min.js"></script>
        <script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
	</head>
  <style>
  .axis
    {font: 10px sans-serif;}
    .axis path,
    .axis line {fill: none;
      stroke: #000; }
      
    
    
    .barchart text
    {
      fill: white;
      font-family: sans-serif;
      font-size: 15px;
      text-anchor: end;
    }
    
    .d3-tip {
    line-height: 1;
    font-weight: bold;
    padding: 12px;
    background: rgba(0, 0, 0, 0.8);
    color: #fff;
    border-radius: 2px;
    }        
    .d3-tip:after {
    box-sizing: border-box;
    display: inline;
    font-size: 10px;
    width: 100%;
    line-height: 1;
    color: rgba(0, 0, 0, 0.8);
    content: "\25BC";
    position: absolute;
    text-align: center;
    }

    .d3-tip.n:after {
    margin: -1px 0 0 0;
    top: 100%;
    left: 0;
    }
  </style>
<h1>World Literacy Map </h1>
<p>Target: Chloropeth Map to show literacy on the scale of Overall primary literacy </p>	
	<body>
<div id="map"></div>

<script>

var map = d3.geomap().geofile('https://d3-geomap.github.io//d3-geomap/topojson/world/countries.json');
//var geo = map.properties;
d3.select('#map')
    .call(map.draw, map);

//var map1 = d3.
    // map[geo][objects][units][geometries][0][id]
//console.log(geofile);
//var countries = topojson.feature(map, map.objects.countries).features
console.log();
//console.log(topojson);

//topojson.feature(usMap, usMap.objects.states).features
   //console.log(map.properties.geometries[1].arcs)
   //console.log(map.geo.objects.units.geometries[0].id); 


//Reference : http://d3-geomap.github.io
    
</script>
<h1>Top Countries Having Maximum Inbound Students b/w 2003-2013</h1>


<div id="chart"></div>
  <script type="text/javascript">
var filteredData;

var rows;
//chrome.exe --allow-file-access-from-files

d3.csv("https://raw.githubusercontent.com/HariPadBharti/D3-Project/master/inbound.csv", function(load) {
  rows = load;
  extract_data();

});



function extract_data() {
var Val;
var a1;
var count;
Val = rows;
console.log(Val[0]);
var top_data; 
top_data = rows[0];
//Val[0]=rows[0];
console.log(rows);
console.log(Val[0].Value);
for(var i=0; i<rows.length; i++)
  {
    a1=rows[i].Value;
    for(var j=i+1; j<rows.length; j++)
    {
      
      if(rows[i].Country==rows[j].Country && rows[i].Value<rows[j].Value)
      {
        Val[i].Value = rows[j].Value;
        
      }
      
    }
  }
  filteredData = rows.filter(function(d) 
{ 
        
        if( d["Time"] == "2013")
        {

         
         
            return d;
         }

    })

console.log(filteredData);
  var filteredData1 = rows.filter(function(d) 
{ 
        
        if( d["LOCATION"] == "USA")
        {

         
         
            return d;
         }

    })

console.log(filteredData1);



//console.log(sorted);
//d3.sort(filteredData);

var bardata = [];
for(var i=0; i<filteredData1.length;i++)
{

}
//top_data.sort(d3.ascending);
//console.log(filteredData); 

//var data = [ {Country : "USA", inbound: 784427}, {Country : "UK", inbound : 416693}, {Country : "AUS", inbound: 249868}, {Country: "FRA", inbound: 239344}, {Country: "GER", inbound: 196619}];




  
  
var margin = {top: 20, right: 20, bottom: 40, left: 40};
var width = 600 - margin.left - margin.right;
var height = 600 - margin.top - margin.bottom;

svg = d3.select("#chart").append("svg")
  .attr("width", width + margin.left + margin.right)
  .attr("height", height + margin.top + margin.bottom)
  .append("g")
  .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


var y = d3.scale.linear().range([height, 0]);

y.domain([0,8])
var yAxis = d3.svg.axis().scale(y).orient("left");
svg.append("g")
  .attr("class", "axis")
  .call(yAxis)
  .append("text")
  .attr("y", -30)
  .attr("x", -80)
  .style("text-anchor","end")
  .attr("transform","rotate(-90)")
  .text("No of Inbound Students (In 100 thousands)")

var bardata = [];
  var valb = []
for(var i=0; i<filteredData.length;i++)
{
bardata[i] = filteredData[i].LOCATION;
valb = filteredData[i].Value;
}
console.log(bardata);
var x = d3.scale.ordinal().rangeRoundBands([0, width]).domain(bardata);

console.log(x.domain());
//x.domain([0,7])
var xAxis = d3.svg.axis().scale(x).orient("bottom");
svg.append("g")
  .attr("class", "x axis")
  .attr("transform", "translate(0," +(height)+ ")")
  .call(xAxis)
  .selectAll("text")
            .style("text-anchor", "end")
            .attr("transform", "rotate(-90)" );

//.outerTickSize(0)


    

//var data = [20,30,40,50,60,70];


svg.append("g")
            .attr("class", "x axis")
            .attr("transform", "translate(0," + height + ")")
            .call(xAxis)
            .selectAll("text")
            .style("text-anchor", "end")
            .attr("transform", "rotate(-90)" );

var tip = d3.tip()
  .attr('class', 'd3-tip')
  .offset([-10, 0])
  .html(function(d) { 
    return "<span style='color:red'>" + d.LOCATION+ " : " + d.Value +"</span>";
  });
  
svg.selectAll("rect")
  .data(filteredData)
  .enter()
  .append("rect")
  .attr("x",  function(d,i){ console.log(x(d.LOCATION),d.LOCATION); return x(d.LOCATION);})
  .attr("y", function(d,i) { return y(d.Value/100000) })
  .attr("width", 110)
  .attr("height", function(d) { return height - y(d.Value/100000); })
  .attr("fill", function(d) 
  { if(d.Value>=400000) 
  return "#0000FF"; 
  else if(d.Value>=300000)
    return "#003399";
  else if(d.Value>=200000)
    return "#0033cc";
  })
  .on('mouseover',tip.show)
  .on('mouseout', tip.hide)

  .selectAll("text")
            .style("text-anchor", "end")
            .attr("transform", "rotate(-90)" );

    
  
      
svg.call(tip);

        

  
}





//attr("y", function(d,i) { return y(d.q4/300000) })
    
  </script>
</div>


	</body>	
</html>